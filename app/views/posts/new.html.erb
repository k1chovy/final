<div class="mt-5 p-4 bg-white shadow-sm rounded">
  <h2>Create New Post</h2>
  
  <!-- Hiển thị thông báo lỗi -->
  <% if @post.errors.any? %>
    <div class="alert alert-danger">
      <h4>There were errors with your submission:</h4>
      <ul>
        <% @post.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form_with(model: @post || Post.new, local: true, class: "row g-3") do |form| %>
    <div class="col-12">
      <%= form.label :title, "Title", class: "form-label" %>
      <%= form.text_field :title, class: "form-control", placeholder: "Enter post title" %>
    </div>
    <div class="col-12">
      <%= form.label :content, "Content", class: "form-label" %>
      <%= form.text_area :content, rows: 3, class: "form-control", placeholder: "Enter post content" %>
    </div>
    <div class="col-12">
      <%= form.label :image, "Upload Image", class: "form-label" %>
      <%= form.file_field :image, class: "form-control", id: "post_image" %>
    </div>
    <div class="col-12">
      <!-- Khung preview hình ảnh -->
      <img id="preview_image" class="img-fluid mt-3" style="max-width: 300px; display: none;" />
    </div>
    <div class="col-12 text-end">
      <%= form.submit "Create Post", class: "btn btn-success" %>
    </div>
  <% end %>
</div>

<!-- Thêm JavaScript trực tiếp vào view -->
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const imageInput = document.getElementById("post_image");
    const previewImage = document.getElementById("preview_image");

    imageInput.addEventListener("change", (event) => {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          previewImage.src = e.target.result;
          previewImage.style.display = "block"; // Hiển thị ảnh preview
        };
        reader.readAsDataURL(file);
      } else {
        previewImage.style.display = "none"; // Ẩn ảnh preview nếu không có file
      }
    });
  });
</script>
